<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="../sakura.png" />
    <title>桜の小破屋</title>
    <script src="../js/vue.js"></script>
    <script src="./js/battle.js"></script>
    <script src="./js/main.js"></script>
    <!-- <script src="../js/jquery-3.6.0.min.js"></script> -->
    <link rel="stylesheet" href="./css/style.css" />
    <style>
        #app .dataList .dataListLi {
            padding: 5px;
            margin-top: 10px;
            width: 100%;
            height: auto;
            border: solid 1px rgb(62, 235, 128);
            font-size: 1.3em;
            font-weight: 550;
            border-radius: 0.8vw;
        }
        
        #app .btn {
            width: 100%;
            height: 50px;
            vertical-align: center;
            line-height: 50px;
            text-align: center;
        }
        
        #app .btn .checkBtn {
            margin: 10px 20px;
            display: inline-block;
            width: 140px;
            height: 50px;
            border-radius: 20px;
            font-size: 1em;
            font-weight: 550;
        }
        
        #app .btn .confirmBtn {
            background: rgb(31, 137, 163, 0.8);
            color: rgb(17, 20, 204);
        }
        
        #app .btn .otherBtn {
            background: rgba(15, 218, 133, 0.8);
            color: rgb(100, 45, 9);
        }
        
        #app .attr {
            min-width: 120px;
            max-width: 100vw;
            padding: 20px;
            margin: 0 5vw;
            margin-top: 1vh;
            overflow: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            border: 1px solid rgba(50, 132, 226, 0.863);
            border-radius: 1.3vw;
        }
        
        #app .attr .zous .zousInfo li,
        #app .attr .zous p {
            font-size: 1.2em;
        }
    </style>
</head>

<body>
    <div id="app">
        <div class="gameName">宙斯之战</div>
        <div class="dataList">
            <ul class="dataListUl" v-for="(data,key,index) in dataList">
                <li v-if="data.round" class="dataListLi">{{data.round}}</li>
                <li v-if="data.appear" class="dataListLi">{{data.appear}}</li>
                <li v-if="data.damage" class="dataListLi">{{data.damage}}</li>
                <li v-if="data.leftBlood" class="dataListLi">{{data.leftBlood}}</li>
                <li v-if="data.die" class="dataListLi">{{data.die}}</li>
                <li v-if="data.xpget" class="dataListLi">{{data.xpget}}</li>
                <li v-if="data.llup" class="dataListLi">{{data.llup}}</li>
            </ul>
        </div>
        <div class="attr">
            <div class="zous">
                <p>宙斯状态:</p>
                <ul class="zousInfo">
                    <li>当前血量:{{vmZous.hp}}</li>
                    <li>当前攻击力:{{vmZous.atta}}</li>
                    <li>当前防御力:{{vmZous.defend}}</li>
                    <li>当前经验:{{vmZous.xp}}/{{vmZous.needXp}}</li>
                    <li>当前等级:{{vmZous.level}}</li>
                </ul>
            </div>
        </div>
        <div class="btn">
            <button class="checkBtn confirmBtn" @click="confirmBtn">
                {{leftBtn}}
            </button>
            <button class="checkBtn otherBtn" @click="otherBtn">
                点击添加list内容
            </button>
        </div>
    </div>

    <script>
        //全局变量区
        var round = 1;
        var continuFlag = true;
        var zous = new Zous(100, 500, 500);
        var boss;
        var ani;

        var vm = new Vue({
            el: "#app",
            data: {
                dataList: [{}],
                leftBtn: "1",
                vmZous: zous,
            },
            methods: {
                confirmBtn() {
                    var _this_round = round - 1;
                    if (_this_round % 5 == 0) {
                        ata(boss, zous);
                    } else {
                        ata(ani, zous);
                    }
                    continuFlag = true;
                    setTimeout(function() {
                        var showContent = document.querySelector(".dataList");
                        showContent.scrollTop = showContent.scrollHeight;
                    }, 5);
                    continuBattle(round);
                },
                otherBtn() {
                    var data = {
                        damage: "不好世界",
                    };
                    this.dataList.push(data);
                    setTimeout(function() {
                        var showContent = document.querySelector(".dataList");
                        showContent.scrollTop = showContent.scrollHeight;
                    }, 5);
                },
            },
        });



        function batt(callback) {
            if (callback && callback instanceof Function) {
                callback();
            }
        }

        function aniCreated(rou) {
            if (rou % 5 == 0) {
                var boss = new Boss(zous);
                continuFlag = false;
                return boss;
            } else {
                var ani = new Ani(zous);
                continuFlag = false;
                return ani;
            }
        }

        function continuBattle(rou) {
            vm.dataList.push({
                round: "第" + rou + "回合",
            });
            if (rou % 5 == 0) {
                console.log('boss生成');
                boss = new aniCreated(rou);
                //console.log(boss);
                vm.dataList.push({
                    appear: boss.appear,
                });
                vm.leftBtn = "攻击Boss";
                continuFlag = false;
                //console.log(JSON.parse(ata(boss, zous)));
                //ata(boss, zous);
                /*returnVal = JSON.parse(ata(boss, zous));
                    console.log(returnVal);
                    vm.dataList.push(returnVal);*/
            } else {
                ani = new aniCreated(rou);
                //console.log(ani);
                vm.dataList.push({
                    appear: ani.appear,
                });
                vm.leftBtn = "攻击怪物";
                continuFlag = false;
                //console.log(JSON.parse(ata(ani, zous)));
                //console.log(ata(ani, zous));
                //ata(ani, zous);
                /*returnVal = JSON.parse(ata(ani, zous));
                    console.log(returnVal);
                    vm.dataList.push(returnVal);*/
            }
            if (zous.hp <= 0) {
                console.log('宙斯死亡');
            };
            round++;
        }
        if (round == 1) {
            continuBattle(round);
            /*
                vm.dataList.push({
                round: "第" + round + "回合",
            });
            if (round % 5 == 0) {
                var boss = new aniCreated(round);
                console.log(boss);
                vm.dataList.push({
                    appear: boss.appear,
                });
                vm.leftBtn = "攻击Boss";
                continuFlag = false;
            } else {
                var ani = new aniCreated(round);
                console.log(ani);
                vm.dataList.push({
                    appear: ani.appear,
                });
                vm.leftBtn = "攻击怪物";
                continuFlag = false;
            }
            if (zous.hp <= 0) break;
            round++;
            */
        }
    </script>
</body>

</html>